---
description: "全言語・全フレームワーク共通の設計・アーキテクチャ指針"
# applyTo: '*'
---

# ソフトウェア設計・アーキテクチャ共通ガイドライン

このドキュメントは、特定の技術に依存しない、全ての言語・フレームワークに共通する設計・アーキテクチャの原則・ベストプラクティスをまとめたものです。

## 必須の思考プロセス

- **実装前に必ず以下を明確化すること：**
  1. 適用する設計パターンや原則（例：DDD、SOLIDなど）
  2. 影響を受けるレイヤ（ドメイン/アプリケーション/インフラ等）
  3. 用語や概念の一貫性（ユビキタス言語）
  4. セキュリティ・コンプライアンス観点
  5. 集約やエンティティ、イベントの設計・変更点
  6. SOLID原則に沿ったインターフェース・クラス設計
  7. 必要なテストとその命名規則

## コア原則

### 1. ドメイン駆動設計（DDD）
- **ユビキタス言語**：ビジネス用語をコード・ドキュメント全体で統一
- **境界づけられたコンテキスト**：責任範囲を明確に分離
- **集約**：一貫性とトランザクション境界を明確化
- **ドメインイベント**：ビジネス上重要な変化を記録・伝播
- **リッチドメインモデル**：ビジネスロジックはドメイン層に集約

### 2. SOLID原則
- **単一責任の原則（SRP）**：クラスやモジュールは1つの責任のみ持つ
- **オープン/クローズド原則（OCP）**：拡張に開き、修正に閉じる
- **リスコフの置換原則（LSP）**：派生型は基底型と置換可能であるべき
- **インターフェース分離原則（ISP）**：利用しないメソッドへの依存を避ける
- **依存性逆転の原則（DIP）**：抽象に依存し、具象に依存しない

### 3. シンプル設計の原則
- **YAGNI (You Aren't Gonna Need It)**：必要になるまで機能を実装しない。将来必要になる「かもしれない」機能は、実際に必要になるまで実装しない。過剰設計や不要な複雑さを避け、現在の要件に集中することで、コードベースを管理しやすく保ち、リソースを効率的に活用する。
- **DRY (Don't Repeat Yourself)**：知識や論理の重複を避ける。同じコード、ロジック、機能が複数の場所に存在すると、変更時に一貫性を保つのが困難になる。代わりに、共通のコードを抽出し、再利用可能なコンポーネントとして実装する。
- **KISS (Keep It Simple, Stupid)**：シンプルさを最優先にする。複雑な解決策よりもシンプルな解決策を選び、不必要な複雑さを避ける。理解しやすく、保守しやすいコードを書くことを目指し、過度に洗練された技術やパターンの使用は慎重に判断する。
- **関心の分離 (Separation of Concerns)**：システムを独立した関心事に分けて設計・実装する。各モジュールやクラスは、特定の機能や責任のみに集中し、他の関心事との結合を最小化する。例えばMVCパターンでは、データ（Model）、表示（View）、制御（Controller）を分離する。これにより、コードの可読性、保守性、テスト容易性が向上し、チーム開発での並行作業も容易になる。

### 4. セキュリティ・コンプライアンス
- **最小権限の原則**：必要最小限の権限のみ付与
- **監査証跡**：重要な操作や状態変化は必ず記録
- **データ保護**：個人情報や機密データの保護を徹底
- **規制対応**：業界・法令要件（例：PCI-DSS、SOX、GDPR等）を考慮

### 5. パフォーマンス・スケーラビリティ
- **非同期・並列処理**：I/Oや重い処理は非同期化し、スケーラブルに
- **最適なデータアクセス**：効率的なクエリ・インデックス設計
- **キャッシュ戦略**：データの揮発性に応じて適切にキャッシュ
- **メモリ効率**：オブジェクトやデータ構造のサイズ・寿命を最適化

### 6. テスト・品質保証
- **テスト命名規則**：`メソッド名_条件_期待結果`パターンを推奨
- **ユニットテスト**：ビジネスロジックを単体で検証
- **統合テスト**：レイヤ間や外部連携の一貫性を検証
- **受け入れテスト**：ユーザーシナリオ全体を検証
- **カバレッジ目標**：主要ロジック層で高いテストカバレッジを維持

### 7. 実装・設計プロセス
- **設計前に必ず要件・用語・責任範囲を明確化**
- **各レイヤの責務分離を徹底**
- **設計原則（SOLID等）に沿った構造化**
- **エラー処理・バリデーション戦略の明確化**
- **パフォーマンス・スケーラビリティ考慮**
- **設計・実装判断は必ずドキュメント化**

### 8. 品質チェックリスト
- 集約やモデルがビジネス概念を正しく表現しているか
- 用語・命名が一貫しているか
- SOLID原則に違反していないか
- ドメインロジックが適切にカプセル化されているか
- 重要なイベントが記録・伝播されているか
- テストが十分かつ命名規則に従っているか
- パフォーマンス・セキュリティ要件を満たしているか
- 重要な設計判断・トレードオフが記録されているか

---

このガイドラインは、堅牢で保守性・拡張性・セキュリティに優れたシステム設計の基盤となるべきものです。プロジェクトや技術スタックを問わず、常に参照・適用してください。

より具体的な実装判断（静的メソッドとインスタンスメソッドの使い分けなど）については、[実装パターン指針](./implementation-patterns-guidelines.instructions.md)を参照してください。
